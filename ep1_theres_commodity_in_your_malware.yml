episode_number: 1
episode_title: There's Commodity in Your Malware
episode_hosts:
- handle: "@Understudy77"
- handle: "@ExiledAtraidez"
episode_guests: ~

detections:
- title: Malicious Macros Running Inside of a Word Document
  description: >
    A behavior with Emotet specifically that hasn't changed has been malicious macros running inside of a  Word document. 
    So there's a behavior that we can work off of that when if we look at the parent/child spawning process relationship. 
  # @here!!
    In the case of malware like this where it's very polymorphic is to find similarities with known bad binaries. In this 
    case they were all a similar size (between 65-74KB) and all unsigned.
  # !!  
  timestamp: "46:42"
  references:
  - https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/macro-malware
  tags:
  - ATT&CK-T1203
  - ATT&CK-T1204.002
  - ATT&CK-T1566.001
  - ATT&CK-S0367
  - ATT&CK-T1314

- title: Microsoft Office Applications Spawning CMD or PowerShell
  description: >
    If you see Word, Excel, or other Office products opening CMD and/or PowerShell that's a high level indicator that 
    something malicious is happening.
  timestamp: "47:02"
  references:
  - https://redcanary.com/blog/testing-the-top-mitre-attck-techniques-powershell-scripting-regsvr32/
  - https://www.elastic.co/guide/en/siem/guide/current/suspicious-ms-office-child-process.html
  - https://www.carbonblack.com/blog/block-powershell-from-launching-via-office-macros-and-scripts/
  tags:
  - ATT&CK-T1204
  - ATT&CK-T1059.001
  - ATT&CK-T1059.003

- title: Mshta connecting to the internet
  description: Mshta can run PowerShell commands without invoking PowerShell. 
  timestamp: "47:32"