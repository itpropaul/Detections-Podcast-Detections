episode_number: 1
episode_title: There's Commodity in Your Malware
episode_hosts:
- handle: "@Understudy77"
- handle: "@ExiledAtraidez"
episode_guests: ~

detections:
- title: Malicious Macros Running Inside of a Word Document
  description: >
    A behavior with Emotet specifically that hasn't changed has been malicious macros running inside of a  Word document. 
    So there's a behavior that we can work off of if we look at the parent/child spawning process relationship. 
  timestamp: "46:42"
  references:
  - https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/macro-malware
  - https://isc.sans.edu/forums/diary/Microsoft+Word+document+with+malicious+macro+pushes+IcedID+Bokbot/26146/
  ATT&CK_urls:
  - https://attack.mitre.org/techniques/T1203/
  - https://attack.mitre.org/techniques/T1204/002/
  - https://attack.mitre.org/techniques/T1566/001/
  - https://attack.mitre.org/techniques/T1314/
  - https://attack.mitre.org/software/S0367/
  ATT&CK_tags:
  - T1203
  - T1204.002
  - T1566.001
  - S0367
  - T1314

- title: Microsoft Office Applications Spawning CMD or PowerShell
  description: >
    If you see Word, Excel, or other Office products opening CMD and/or PowerShell that's a high level indicator that 
    something malicious is happening.
  timestamp: "47:02"
  references:
  - https://redcanary.com/blog/testing-the-top-mitre-attck-techniques-powershell-scripting-regsvr32/
  - https://www.elastic.co/guide/en/siem/guide/current/suspicious-ms-office-child-process.html
  - https://www.carbonblack.com/blog/block-powershell-from-launching-via-office-macros-and-scripts/
  ATT&CK_urls:
  - https://attack.mitre.org/techniques/T1204/
  - https://attack.mitre.org/techniques/T1059/001/
  - https://attack.mitre.org/techniques/T1059/003/
  ATT&CK_tags:
  - T1204
  - T1059.001
  - T1059.003

- title: Mshta connecting to the internet
  description: Mshta can run PowerShell commands without invoking powershell.exe. 
  timestamp: "47:32"
  references:
  - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997
  - https://github.com/jpginc/pentesting-hta/blob/master/powershell.hta
  - https://www.microsoft.com/security/blog/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/
  - https://www.cylance.com/content/dam/cylance/pdfs/reports/Op_Dust_Storm_Report.pdf
  ATT&CK_urls:
  - https://attack.mitre.org/techniques/T1218/005/
  ATT&CK_tags:
  - T1218.005